name: Scaffold tfmigrate migration pull request
description: Scaffold tfmigrate migration pull request
inputs:
  github_token:
    description: |
      GitHub Access Token
      pull-requests:read - Checkout pull requests
      pull-requests:write - Add labels to pull requests
      issues:write - Create labels
      contents:write - Create branches
      If skip_create_pr is false
      pull-requests:write - Create pull requests

    required: true

  migration_name:
    description: "Migration name"
    required: false
    default: main

  pr_number:
    description: Pull Request Number
    required: false

  securefix_action_app_id:
    description: |
      GitHub App ID for Securefix Action
      issues:write
    required: false
  securefix_action_app_private_key:
    description: |
      GitHub App Private Key for Securefix Action
    required: false
outputs:
  working_directory:
    description: Working Directory
    value: ${{steps.scaffold-tfmigrate.outputs.working_directory}}

runs:
  using: composite
  steps:
    - uses: suzuki-shunsuke/tfaction@main
      with:
        action: install
    - uses: suzuki-shunsuke/tfaction@main
      id: scaffold-tfmigrate
      with:
        action: scaffold-tfmigrate
        github_token: ${{inputs.github_token}}
        migration_name: ${{inputs.migration_name}}
        pr_number: ${{inputs.pr_number}}
        securefix_action_app_id: ${{inputs.securefix_action_app_id}}
        securefix_action_app_private_key: ${{inputs.securefix_action_app_private_key}}
