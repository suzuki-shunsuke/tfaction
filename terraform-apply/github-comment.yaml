# https://github.com/suzuki-shunsuke/github-comment
post:
  invalid-workflow-sha:
    template: |
      ## :x: {{if .Vars.tfaction_target}}{{.Vars.tfaction_target}}: {{end}}workflow run's headSha is invalid

      {{template "link" .}}

      It failed to get a Terraform plan file from the pull request workflow run's artifacts.
      workflow run's headSha ({{.Vars.wf_sha}}) is different from the associated pull request's head sha ({{.Vars.pr_sha}}).

exec:
  default:
    - when: ExitCode != 0
      template: |
        :x: {{.Vars.tfaction_target}}

        {{template "link" .}}

        {{template "join_command" .}}

        {{template "hidden_combined_output" .}}

  invalid-plan-workflow-name:
    - when: ExitCode != 0
      template: |
        ## :x: Failed to get the workflow `{{.Vars.plan_workflow_name}}` ({{.Vars.tfaction_target}})

        {{template "link" .}}

        It failed to view the workflow `{{.Vars.plan_workflow_name}}`.
        Probably the setting `plan_workflow_name` in `tfaction-root.yaml` is wrong.

        {{template "join_command" .}}

        {{template "hidden_combined_output" .}}
