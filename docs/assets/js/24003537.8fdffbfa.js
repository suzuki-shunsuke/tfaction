"use strict";(globalThis.webpackChunktfaction=globalThis.webpackChunktfaction||[]).push([[5427],{5746(e,n,t){t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>c,default:()=>h,frontMatter:()=>l,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"upgrade-guide/v2","title":"Upgrade to v2","description":"v2 hasn\'t been released yet.","source":"@site/docs/upgrade-guide/v2.md","sourceDirName":"upgrade-guide","slug":"/upgrade-guide/v2","permalink":"/tfaction/docs/upgrade-guide/v2","draft":false,"unlisted":false,"editUrl":"https://github.com/suzuki-shunsuke/tfaction-docs/edit/main/docs/upgrade-guide/v2.md","tags":[],"version":"current","sidebarPosition":100,"frontMatter":{"sidebar_position":100},"sidebar":"tutorialSidebar","previous":{"title":"Upgrade Guide","permalink":"/tfaction/docs/upgrade-guide/"},"next":{"title":"tfaction","permalink":"/tfaction/docs/unreleased/"}}');var s=t(4848),r=t(8453);const l={sidebar_position:100},c="Upgrade to v2",o={},a=[{value:"Upgrade Using AI",id:"upgrade-using-ai",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Overview",id:"overview",level:2},{value:"Replace <code>suzuki-shunsuke/tfaction/*</code> with <code>suzuki-shunsuke/tfaction-action</code> and set the input <code>action</code>",id:"replace-suzuki-shunsuketfaction-with-suzuki-shunsuketfaction-action-and-set-the-input-action",level:2},{value:"Modify authentication",id:"modify-authentication",level:2},{value:"Replace <code>tfaction-go</code>",id:"replace-tfaction-go",level:2},{value:"Change <code>plan_workflow_name</code> from the workflow name to the workflow file name",id:"change-plan_workflow_name-from-the-workflow-name-to-the-workflow-file-name",level:2},{value:"Remove configuration for tfsec",id:"remove-configuration-for-tfsec",level:2},{value:"Remove <code>target</code> from <code>label_prefixes</code>",id:"remove-target-from-label_prefixes",level:2},{value:"Replace the setting <code>conftest_policy_directory</code> with <code>conftest</code>",id:"replace-the-setting-conftest_policy_directory-with-conftest",level:2},{value:"Configure <code>conftest</code> explicitly if you want to run Conftest",id:"configure-conftest-explicitly-if-you-want-to-run-conftest",level:2},{value:"Replace <code>.target_groups[].target</code> with the setting <code>replace_target</code>",id:"replace-target_groupstarget-with-the-setting-replace_target",level:2},{value:"Replace <code>replace</code> with the setting <code>replace_target</code>",id:"replace-replace-with-the-setting-replace_target",level:2},{value:"Modify <code>.follow_up_pr_group_label</code> to <code>.follow_up_pr.group_label</code>",id:"modify-follow_up_pr_group_label-to-follow_up_prgroup_label",level:2},{value:"Modify template files to use Handlebars",id:"modify-template-files-to-use-handlebars",level:2},{value:"CI doesn&#39;t fail anymore even if the pull request is created by Renovate and <code>terraform plan</code> has changes",id:"ci-doesnt-fail-anymore-even-if-the-pull-request-is-created-by-renovate-and-terraform-plan-has-changes",level:2}];function d(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"upgrade-to-v2",children:"Upgrade to v2"})}),"\n",(0,s.jsx)(n.admonition,{type:"warning",children:(0,s.jsx)(n.p,{children:"v2 hasn't been released yet.\nThe content of this page is unstable."})}),"\n",(0,s.jsx)(n.p,{children:"This document describes how to upgrade to v2.\nThe upgrade has some breaking changes."}),"\n",(0,s.jsx)(n.h2,{id:"upgrade-using-ai",children:"Upgrade Using AI"}),"\n",(0,s.jsx)(n.p,{children:"Prompt:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"Upgrade tfaction to v2 according to the guide.\n"})}),"\n",(0,s.jsx)(n.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"https://github.com/suzuki-shunsuke/tfaction",children:"tfaction"})," is GitHub Actions for Terraform.\nIt has a configuration file named ",(0,s.jsx)(n.code,{children:"tfaction-root.yaml"}),".\nBy default, it is located in the root directory of the repository.\nBut if it doesn't found, please check the environment variable ",(0,s.jsx)(n.code,{children:"TFACTION_CONFIG"})," in workflow files."]}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Modify GitHub Actions Workflows","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#replace-suzuki-shunsuketfaction-with-suzuki-shunsuketfaction-action-and-set-the-input-action",children:["Replace ",(0,s.jsx)(n.code,{children:"suzuki-shunsuke/tfaction/*"})," with ",(0,s.jsx)(n.code,{children:"suzuki-shunsuke/tfaction-action"})," and set the input ",(0,s.jsx)(n.code,{children:"action"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#modify-authentication",children:"Modify authentication"})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#replace-tfaction-go",children:["Replace ",(0,s.jsx)(n.code,{children:"tfaction-go"})]})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Modify tfaction-root.yaml","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#change-plan_workflow_name-from-the-workflow-name-to-the-workflow-file-name",children:["Change ",(0,s.jsx)(n.code,{children:"plan_workflow_name"})," from the workflow name to the workflow file name"]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#remove-configuration-for-tfsec",children:"Remove configuration for tfsec"})}),"\n",(0,s.jsxs)(n.li,{children:["Remove ",(0,s.jsx)(n.code,{children:"target"})," from ",(0,s.jsx)(n.code,{children:"label_prefixes"})]}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#replace-the-setting-conftest_policy_directory-with-conftest",children:["Replace the setting ",(0,s.jsx)(n.code,{children:"conftest_policy_directory"})," with ",(0,s.jsx)(n.code,{children:"conftest"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#configure-conftest-explicitly-if-you-want-to-run-conftest",children:["Configure ",(0,s.jsx)(n.code,{children:"conftest"})," explicitly if you want to run Conftest"]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#replace-target_groupstarget-with-the-setting-replace_target",children:["Replace ",(0,s.jsx)(n.code,{children:".target_groups[].target"})," with the setting ",(0,s.jsx)(n.code,{children:"replace_target"})]})}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#replace-replace-with-the-setting-replace_target",children:["Replace ",(0,s.jsx)(n.code,{children:"replace"})," with the setting ",(0,s.jsx)(n.code,{children:"replace_target"})]})}),"\n",(0,s.jsxs)(n.li,{children:["Remove the suffix ",(0,s.jsx)(n.code,{children:"/"})," from ",(0,s.jsx)(n.code,{children:".target_groups[].working_directory"})]}),"\n",(0,s.jsx)(n.li,{children:"Modify file path settings (working_directory, template_dir, conftest.policy) to relative paths from git root directory"}),"\n",(0,s.jsx)(n.li,{children:(0,s.jsxs)(n.a,{href:"#modify-follow_up_pr_group_label-to-follow_up_prgroup_label",children:["Modify ",(0,s.jsx)(n.code,{children:".follow_up_pr_group_label"})," to ",(0,s.jsx)(n.code,{children:".follow_up_pr.group_label"})]})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Modify template files","\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:(0,s.jsx)(n.a,{href:"#modify-template-files-to-use-handlebars",children:"Modify template files to use Handlebars"})}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["Modify ",(0,s.jsx)(n.code,{children:"renovate.json"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Remove the label ",(0,s.jsx)(n.code,{children:"renovate-change"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.h2,{id:"replace-suzuki-shunsuketfaction-with-suzuki-shunsuketfaction-action-and-set-the-input-action",children:["Replace ",(0,s.jsx)(n.code,{children:"suzuki-shunsuke/tfaction/*"})," with ",(0,s.jsx)(n.code,{children:"suzuki-shunsuke/tfaction-action"})," and set the input ",(0,s.jsx)(n.code,{children:"action"})]}),"\n",(0,s.jsxs)(n.p,{children:["Previously, tfaction was composed of many separate actions.\nAs of v2, it has now been fully rewritten as a single JavaScript Action.\nThe ",(0,s.jsx)(n.code,{children:"action"})," input is used to select functionalities such as ",(0,s.jsx)(n.code,{children:"plan"}),", ",(0,s.jsx)(n.code,{children:"apply"}),", and ",(0,s.jsx)(n.code,{children:"test"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"uses: suzuki-shunsuke/tfaction/plan@v1.20.1\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"uses: suzuki-shunsuke/tfaction@347350d46b42cfd1b7dfec08385cfb2d196ae657 # v2.0.0-0\nwith:\n  action: plan\n"})}),"\n",(0,s.jsxs)(n.p,{children:["The input ",(0,s.jsx)(n.code,{children:"action"})," supports the following values:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"apply"}),"\n",(0,s.jsx)(n.li,{children:"create-drift-issues"}),"\n",(0,s.jsx)(n.li,{children:"create-follow-up-pr"}),"\n",(0,s.jsx)(n.li,{children:"create-scaffold-module-pr"}),"\n",(0,s.jsx)(n.li,{children:"create-scaffold-pr"}),"\n",(0,s.jsx)(n.li,{children:"export-aws-secrets-manager"}),"\n",(0,s.jsx)(n.li,{children:"export-secrets"}),"\n",(0,s.jsx)(n.li,{children:"generate-config-out"}),"\n",(0,s.jsx)(n.li,{children:"get-global-config"}),"\n",(0,s.jsx)(n.li,{children:"get-or-create-drift-issue"}),"\n",(0,s.jsx)(n.li,{children:"get-target-config"}),"\n",(0,s.jsx)(n.li,{children:"list-targets"}),"\n",(0,s.jsx)(n.li,{children:"pick-out-drift-issues"}),"\n",(0,s.jsx)(n.li,{children:"plan"}),"\n",(0,s.jsx)(n.li,{children:"release-module"}),"\n",(0,s.jsx)(n.li,{children:"scaffold-module"}),"\n",(0,s.jsx)(n.li,{children:"scaffold-tfmigrate"}),"\n",(0,s.jsx)(n.li,{children:"scaffold-working-dir"}),"\n",(0,s.jsx)(n.li,{children:"set-drift-env"}),"\n",(0,s.jsx)(n.li,{children:"setup"}),"\n",(0,s.jsx)(n.li,{children:"sync-drift-issue-description"}),"\n",(0,s.jsx)(n.li,{children:"terraform-init"}),"\n",(0,s.jsx)(n.li,{children:"test"}),"\n",(0,s.jsx)(n.li,{children:"test-module"}),"\n",(0,s.jsx)(n.li,{children:"update-drift-issue"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"modify-authentication",children:"Modify authentication"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"aws-actions/configure-aws-credentials"})," and ",(0,s.jsx)(n.code,{children:"google-github-actions/auth"})," after ",(0,s.jsx)(n.code,{children:"setup"})," if necessary"]}),"\n",(0,s.jsxs)(n.li,{children:["Run ",(0,s.jsx)(n.code,{children:"terraform-init"})," action after ",(0,s.jsx)(n.code,{children:"setup"})]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"setup"})," action doesn't run ",(0,s.jsx)(n.code,{children:"aws-actions/configure-aws-credentials"})," and ",(0,s.jsx)(n.code,{children:"google-github-actions/auth"}),", and it doesn't run ",(0,s.jsx)(n.code,{children:"terraform init"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"e.g."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"- name: Set up\n  uses: suzuki-shunsuke/tfaction@347350d46b42cfd1b7dfec08385cfb2d196ae657 # v2.0.0-0\n  id: setup\n  with:\n    action: setup\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n\n- uses: aws-actions/configure-aws-credentials@61815dcd50bd041e203e49132bacad1fd04d2708 # v5.1.1\n  if: steps.setup.outputs.aws_assume_role_arn != ''\n  with:\n    role-to-assume: ${{ steps.setup.outputs.aws_assume_role_arn }}\n    role-session-name: ${{ steps.setup.outputs.aws_role_session_name }}\n    aws-region: ${{ steps.setup.outputs.aws_region }}\n\n- name: Get Secrets from AWS Secrets Manager\n  if: steps.setup.outputs.aws_assume_role_arn != ''\n  uses: suzuki-shunsuke/tfaction@347350d46b42cfd1b7dfec08385cfb2d196ae657 # v2.0.0-0\n  with:\n    action: export-aws-secrets-manager\n\n- name: terraform init\n  uses: suzuki-shunsuke/tfaction@347350d46b42cfd1b7dfec08385cfb2d196ae657 # v2.0.0-0\n  with:\n    action: terraform-init\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"replace-tfaction-go",children:["Replace ",(0,s.jsx)(n.code,{children:"tfaction-go"})]}),"\n",(0,s.jsxs)(n.p,{children:["If you haven't used ",(0,s.jsx)(n.code,{children:"tfaction-go"}),", you can skip this step."]}),"\n",(0,s.jsx)(n.p,{children:"tfaction-go's sub commands:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"create-drift-issues"}),"\n",(0,s.jsx)(n.li,{children:"get-or-create-drift-issue"}),"\n",(0,s.jsx)(n.li,{children:"pick-out-drift-issues"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"- run: tfaction create-drift-issues\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction@347350d46b42cfd1b7dfec08385cfb2d196ae657 # v2.0.0-0\n  with:\n    action: create-drift-issues\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"change-plan_workflow_name-from-the-workflow-name-to-the-workflow-file-name",children:["Change ",(0,s.jsx)(n.code,{children:"plan_workflow_name"})," from the workflow name to the workflow file name"]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"plan_workflow_name: test\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"plan_workflow_name: test.yaml\n"})}),"\n",(0,s.jsx)(n.h2,{id:"remove-configuration-for-tfsec",children:"Remove configuration for tfsec"}),"\n",(0,s.jsx)(n.p,{children:"Remove the setting from tfaction-root.yaml."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"tfsec:\n  enabled: true\n"})}),"\n",(0,s.jsx)(n.p,{children:"If you want to use trivy instead, you can enable it in tfaction-root.yaml.\ntrivy is enabled by default."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"trivy:\n  enabled: true\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"remove-target-from-label_prefixes",children:["Remove ",(0,s.jsx)(n.code,{children:"target"})," from ",(0,s.jsx)(n.code,{children:"label_prefixes"})]}),"\n",(0,s.jsxs)(n.p,{children:["Labels ",(0,s.jsx)(n.code,{children:"target:<target>"})," were abandoned."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'label_prefixes:\n  target: "target:" # Remove the key `target`\n'})}),"\n",(0,s.jsxs)(n.h2,{id:"replace-the-setting-conftest_policy_directory-with-conftest",children:["Replace the setting ",(0,s.jsx)(n.code,{children:"conftest_policy_directory"})," with ",(0,s.jsx)(n.code,{children:"conftest"})]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"conftest_policy_directory: policy\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"conftest:\n  policies:\n    - policy: policy\n      plan: true\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"configure-conftest-explicitly-if-you-want-to-run-conftest",children:["Configure ",(0,s.jsx)(n.code,{children:"conftest"})," explicitly if you want to run Conftest"]}),"\n",(0,s.jsxs)(n.p,{children:["As of tfaction v2, tfaction doesn't run Conftest implicitly even if the directory ",(0,s.jsx)(n.code,{children:"policy"})," exists unless Conftest is configured explicitly."]}),"\n",(0,s.jsx)(n.p,{children:"e.g."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"conftest:\n  policies:\n    - policy: policy\n      plan: true\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"replace-target_groupstarget-with-the-setting-replace_target",children:["Replace ",(0,s.jsx)(n.code,{children:".target_groups[].target"})," with the setting ",(0,s.jsx)(n.code,{children:"replace_target"})]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"target_groups:\n  - working_directory: github/services/\n    target: github/\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"replace_target:\n  patterns:\n    - regexp: /services/\n      replace: /\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"replace-replace-with-the-setting-replace_target",children:["Replace ",(0,s.jsx)(n.code,{children:"replace"})," with the setting ",(0,s.jsx)(n.code,{children:"replace_target"})]}),"\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"replace"})," was renamed to ",(0,s.jsx)(n.code,{children:"replace_target"}),"."]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"replace:\n  patterns:\n    - regexp: /services/\n      replace: /\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"replace_target:\n  patterns:\n    - regexp: /services/\n      replace: /\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"modify-follow_up_pr_group_label-to-follow_up_prgroup_label",children:["Modify ",(0,s.jsx)(n.code,{children:".follow_up_pr_group_label"})," to ",(0,s.jsx)(n.code,{children:".follow_up_pr.group_label"})]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'follow_up_pr_group_label:\n  enabled: true\n  prefix: "tfaction:follow-up-pr-group/"\n'})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'follow_up_pr:\n  group_label:\n    enabled: true\n    prefix: "tfaction:follow-up-pr-group/"\n'})}),"\n",(0,s.jsx)(n.h2,{id:"modify-template-files-to-use-handlebars",children:"Modify template files to use Handlebars"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://handlebarsjs.com/",children:"Handlebars"})}),"\n",(0,s.jsx)(n.p,{children:"You need to modify placeholders in template files."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Change ",(0,s.jsx)(n.code,{children:"%%...%%"})," to ",(0,s.jsx)(n.code,{children:"{{...}}"})]}),"\n",(0,s.jsx)(n.li,{children:"Lower cases"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:"Before:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"%%MODULE_NAME%%\n"})}),"\n",(0,s.jsx)(n.p,{children:"After:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{children:"{{module_name}}\n"})}),"\n",(0,s.jsxs)(n.h2,{id:"ci-doesnt-fail-anymore-even-if-the-pull-request-is-created-by-renovate-and-terraform-plan-has-changes",children:["CI doesn't fail anymore even if the pull request is created by Renovate and ",(0,s.jsx)(n.code,{children:"terraform plan"})," has changes"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://github.com/suzuki-shunsuke/tfaction/issues/3571",children:"#3571"})}),"\n",(0,s.jsxs)(n.p,{children:["Previously, tfaction failed if the pull request was created by Renovate and ",(0,s.jsx)(n.code,{children:"terraform plan"})," had changes.\nTo pass CI, you need to add the label ",(0,s.jsx)(n.code,{children:"renovate-change"})," to the pull request."]}),"\n",(0,s.jsxs)(n.p,{children:["As of tfaction v2, tfaction doesn't fail anymore.\nInstead, tfaction disables ",(0,s.jsx)(n.code,{children:"auto-merge"})," if the pull request is created by Renovate and ",(0,s.jsx)(n.code,{children:"terraform plan"})," has changes.\nIf ",(0,s.jsx)(n.code,{children:"accept_change_by_renovate: true"})," is set in ",(0,s.jsx)(n.code,{children:"tfaction.yaml"}),", ",(0,s.jsx)(n.code,{children:"auto-merge"})," isn't disabled.\nBasically, ",(0,s.jsx)(n.code,{children:"accept_change_by_renovate: true"})," shouldn't be set.\nThis setting is used in test directories to test changes of workflow in pull request CI."]})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>l,x:()=>c});var i=t(6540);const s={},r=i.createContext(s);function l(e){const n=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:n},e.children)}}}]);