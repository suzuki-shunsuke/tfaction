"use strict";(globalThis.webpackChunktfaction=globalThis.webpackChunktfaction||[]).push([[5183],{5093(e,t,n){n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>l,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>a});const r=JSON.parse('{"id":"feature/scaffold-working-dir","title":"Scaffold working directory","description":"Scaffold working directory by workflow_dispatch","source":"@site/docs/feature/scaffold-working-dir.md","sourceDirName":"feature","slug":"/feature/scaffold-working-dir","permalink":"/tfaction/docs/feature/scaffold-working-dir","draft":false,"unlisted":false,"editUrl":"https://github.com/suzuki-shunsuke/tfaction-docs/edit/main/docs/feature/scaffold-working-dir.md","tags":[],"version":"current","sidebarPosition":350,"frontMatter":{"sidebar_position":350,"description":"Scaffold working directory by workflow_dispatch"},"sidebar":"tutorialSidebar","previous":{"title":"Safe update by Renovate","permalink":"/tfaction/docs/feature/renovate"},"next":{"title":"tfmigrate","permalink":"/tfaction/docs/feature/tfmigrate"}}');var i=n(4848),o=n(8453);const s={sidebar_position:350,description:"Scaffold working directory by workflow_dispatch"},l="Scaffold working directory",c={},a=[{value:"Placeholders",id:"placeholders",level:2},{value:"\ud83d\udca1 Skip creating pull requests",id:"bulb-skip-creating-pull-requests",level:2}];function d(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"scaffold-working-directory",children:"Scaffold working directory"})}),"\n",(0,i.jsx)(t.p,{children:"When you add a new working directory, you can scaffold the directory by GitHub Actions.\ntfaction provides a workflow for it."}),"\n",(0,i.jsxs)(t.ol,{children:["\n",(0,i.jsx)(t.li,{children:"Prepare template directories to scaffold working directories."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction-example/tree/main/templates/github",children:"example"})}),"\n",(0,i.jsxs)(t.ol,{start:"2",children:["\n",(0,i.jsxs)(t.li,{children:["Configure ",(0,i.jsx)(t.code,{children:"tfaction-root.yaml"}),"'s ",(0,i.jsx)(t.code,{children:"target_groups"})," to use the template."]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction-example/blob/4aa980bd9ab572c0bc9244d54eac5215d81ed754/tfaction-root.yaml#L36",children:"example"})}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-yaml",children:"target_groups:\n  - template_dir: templates/github\n    # ...\n"})}),"\n",(0,i.jsxs)(t.ol,{start:"3",children:["\n",(0,i.jsx)(t.li,{children:"Set up the workflow"}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction-example/blob/main/.github/workflows/scaffold-working-directory.yaml",children:"example"})}),"\n",(0,i.jsxs)(t.ol,{start:"4",children:["\n",(0,i.jsx)(t.li,{children:"Execute GitHub Actions Workflow manually."}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://user-images.githubusercontent.com/13323303/150027710-19ce0659-4a7a-490d-ad7b-bf77e409099f.png",alt:"image"})}),"\n",(0,i.jsx)(t.p,{children:"Then a pull request would be created."}),"\n",(0,i.jsx)(t.p,{children:(0,i.jsx)(t.img,{src:"https://user-images.githubusercontent.com/13323303/151699745-b8743536-7e54-41e1-8f8e-73fdf296fef4.png",alt:"image"})}),"\n",(0,i.jsx)(t.p,{children:"Compared with executing commands at the localhost, GitHub Actions has the following merits."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:["GitHub Actions doesn't depend on you local environment","\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsx)(t.li,{children:"You don't have to install tools at local"}),"\n",(0,i.jsx)(t.li,{children:"You can avoid the trouble due to the difference of local environment"}),"\n",(0,i.jsx)(t.li,{children:"GitHub Actions log is useful for trouble shooting"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(t.h2,{id:"placeholders",children:"Placeholders"}),"\n",(0,i.jsx)(t.p,{children:"The following placeholders in templates are replaced."}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"%%TARGET%%"}),": target"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"%%S3_BUCKET_NAME_TFMIGRATE_HISTORY%%"}),": S3 Bucket Name for tfmigrate history files"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.code,{children:"%%GCS_BUCKET_NAME_TFMIGRATE_HISTORY%%"}),": GCS Bucket Name for tfmigrate history files"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"e.g."}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-tf",children:'terraform {\n  required_version = ">= 1.0"\n  backend "s3" {\n    bucket = "S3 Bucket Name"\n    key    = "%%TARGET%%/v1/terraform.tfstate" # Placeholder\n    region = "us-east-1"\n  }\n}\n'})}),"\n",(0,i.jsxs)(t.h2,{id:"bulb-skip-creating-pull-requests",children:["\ud83d\udca1"," Skip creating pull requests"]}),"\n",(0,i.jsxs)(t.p,{children:["If you don't want to create pull requests by GitHub App, please see ",(0,i.jsx)(t.a,{href:"/tfaction/docs/feature/skip-creating-pr",children:"Support skipping creating pull requests"}),"."]})]})}function u(e={}){const{wrapper:t}={...(0,o.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,t,n){n.d(t,{R:()=>s,x:()=>l});var r=n(6540);const i={},o=r.createContext(i);function s(e){const t=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:t},e.children)}}}]);