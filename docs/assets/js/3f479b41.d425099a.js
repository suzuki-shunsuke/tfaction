"use strict";(self.webpackChunktfaction=self.webpackChunktfaction||[]).push([[803],{179:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>u,contentTitle:()=>i,default:()=>c,frontMatter:()=>l,metadata:()=>r,toc:()=>d});const r=JSON.parse('{"id":"feature/auto-update-related-prs","title":"Automatically update related pull requests when the remote state is updated","description":"When terraform plan or tfmigrate plan is run in target A,","source":"@site/docs/feature/auto-update-related-prs.md","sourceDirName":"feature","slug":"/feature/auto-update-related-prs","permalink":"/tfaction/docs/feature/auto-update-related-prs","draft":false,"unlisted":false,"editUrl":"https://github.com/suzuki-shunsuke/tfaction-docs/edit/main/docs/feature/auto-update-related-prs.md","tags":[],"version":"current","sidebarPosition":100,"frontMatter":{"sidebar_position":100},"sidebar":"tutorialSidebar","previous":{"title":"Apply safely with Terraform Plan File","permalink":"/tfaction/docs/feature/plan-file"},"next":{"title":"Create a pull request automatically to handle the problem when apply failed","permalink":"/tfaction/docs/feature/follow-up-pr"}}');var s=a(4848),n=a(8453);const l={sidebar_position:100},i="Automatically update related pull requests when the remote state is updated",u={},d=[{value:"Exclude specific pull requests",id:"exclude-specific-pull-requests",level:2},{value:"Disable this feature",id:"disable-this-feature",level:2}];function o(e){const t={a:"a",admonition:"admonition",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",img:"img",p:"p",pre:"pre",...(0,n.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"automatically-update-related-pull-requests-when-the-remote-state-is-updated",children:"Automatically update related pull requests when the remote state is updated"})}),"\n",(0,s.jsxs)(t.p,{children:["When ",(0,s.jsx)(t.code,{children:"terraform plan"})," or ",(0,s.jsx)(t.code,{children:"tfmigrate plan"})," is run in target ",(0,s.jsx)(t.code,{children:"A"}),",\ntfaction sets a pull request label ",(0,s.jsx)(t.code,{children:"A"}),"."]}),"\n",(0,s.jsxs)(t.p,{children:["When a pull request of the target ",(0,s.jsx)(t.code,{children:"A"})," is merged and ",(0,s.jsx)(t.code,{children:"terraform apply"})," or ",(0,s.jsx)(t.code,{children:"tfmigrate apply"})," is run in target ",(0,s.jsx)(t.code,{children:"A"}),",\ntfaction updates pull request branches that have a pull request label ",(0,s.jsx)(t.code,{children:"A"})," by using the ",(0,s.jsx)(t.a,{href:"https://docs.github.com/en/rest/reference/pulls#update-a-pull-request-branch",children:"GitHub API"}),"."]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{src:"https://user-images.githubusercontent.com/13323303/151699327-ba31892c-c4a6-47e7-a944-15fca81dfbfb.png",alt:"image"})}),"\n",(0,s.jsxs)(t.p,{children:["By updating pull request branch, the result of CI including uploaded Terraform Plan file is updated.\nOtherwise,the uploaded Terraform Plan file becomes stale and it would fail to run ",(0,s.jsx)(t.code,{children:"terraform apply"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"exclude-specific-pull-requests",children:"Exclude specific pull requests"}),"\n",(0,s.jsxs)(t.p,{children:["tfaction >= v0.7.3 ",(0,s.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction/pull/1272",children:"#1272"})]}),"\n",(0,s.jsxs)(t.p,{children:["If you want to exclude specific pull requests, please add the pull request label ",(0,s.jsx)(t.code,{children:"tfaction:disable-auto-update"}),"."]}),"\n",(0,s.jsx)(t.h2,{id:"disable-this-feature",children:"Disable this feature"}),"\n",(0,s.jsxs)(t.p,{children:["tfaction >= v0.5.23 ",(0,s.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction/issues/892",children:"#892"})," ",(0,s.jsx)(t.a,{href:"https://github.com/suzuki-shunsuke/tfaction/pull/898",children:"#898"})]}),"\n",(0,s.jsxs)(t.admonition,{type:"caution",children:[(0,s.jsx)(t.p,{children:"We don't recommend disabling this feature."}),(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsxs)(t.p,{children:["By updating pull request branch, the result of CI including uploaded Terraform Plan file is updated.\nOtherwise, an uploaded Terraform Plan file becomes stale and it would fail to run ",(0,s.jsx)(t.code,{children:"terraform apply"}),"."]}),"\n"]}),(0,s.jsx)(t.p,{children:"If this feature is disabled, users may forget to update Terraform Plan files and terraform apply fails."}),(0,s.jsx)(t.p,{children:"In some use case the maintainer of workflows and users of workflows are different.\nIn that case, users aren't familiar with tfaction and they don't know that they have to update the plan file.\nAnd they can't understand the cause when terraform apply fails."}),(0,s.jsx)(t.p,{children:"So we recommend enabling this feature, but you can disable this feature at your own risk."})]}),"\n",(0,s.jsx)(t.p,{children:"You can disable this feature."}),"\n",(0,s.jsx)(t.p,{children:"tfaction-root.yaml"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-yaml",children:"update_related_pull_requests:\n  enabled: false\n"})})]})}function c(e={}){const{wrapper:t}={...(0,n.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(o,{...e})}):o(e)}},8453:(e,t,a)=>{a.d(t,{R:()=>l,x:()=>i});var r=a(6540);const s={},n=r.createContext(s);function l(e){const t=r.useContext(n);return r.useMemo((function(){return"function"==typeof e?e(t):{...t,...e}}),[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(n.Provider,{value:t},e.children)}}}]);