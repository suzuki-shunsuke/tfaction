"use strict";(globalThis.webpackChunktfaction=globalThis.webpackChunktfaction||[]).push([[3724],{3852(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>u,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"unreleased/overview","title":"What is tfaction","description":"tfaction is a set of GitHub Actions for building workflows that run Terraform or OpenTofu on GitHub Actions.","source":"@site/docs/unreleased/overview.md","sourceDirName":"unreleased","slug":"/unreleased/overview","permalink":"/tfaction/docs/unreleased/overview","draft":false,"unlisted":false,"editUrl":"https://github.com/suzuki-shunsuke/tfaction-docs/edit/main/docs/unreleased/overview.md","tags":[],"version":"current","sidebarPosition":100,"frontMatter":{"sidebar_position":100},"sidebar":"tutorialSidebar","previous":{"title":"tfaction","permalink":"/tfaction/docs/unreleased/"},"next":{"title":"Getting Started","permalink":"/tfaction/docs/unreleased/getting-started"}}');var i=t(4848),o=t(8453);const s={sidebar_position:100},a="What is tfaction",l={},c=[{value:"Features",id:"features",level:2},{value:"Monorepo Support",id:"monorepo-support",level:2},{value:"Clear PR Comments for <code>terraform plan</code> and <code>apply</code> Results",id:"clear-pr-comments-for-terraform-plan-and-apply-results",level:2},{value:"Linting",id:"linting",level:2},{value:"Automatic Code Fixes",id:"automatic-code-fixes",level:2},{value:"Safe <code>apply</code> Using Plan Files",id:"safe-apply-using-plan-files",level:2},{value:"Auto-disable Renovate Auto-merge When <code>terraform plan</code> Shows Changes",id:"auto-disable-renovate-auto-merge-when-terraform-plan-shows-changes",level:2},{value:"Automatically Create Follow-up PRs When <code>terraform apply</code> Fails",id:"automatically-create-follow-up-prs-when-terraform-apply-fails",level:2},{value:"Scaffold Working Directory Workflow",id:"scaffold-working-directory-workflow",level:2},{value:"Drift Detection",id:"drift-detection",level:2},{value:"Support for OpenTofu and Terragrunt",id:"support-for-opentofu-and-terragrunt",level:2},{value:"tfmigrate",id:"tfmigrate",level:2},{value:"CSM (Client/Server Model) Actions (Securefix Action) Support",id:"csm-clientserver-model-actions-securefix-action-support",level:2},{value:"Import via <code>terraform plan -generate-config-out</code>",id:"import-via-terraform-plan--generate-config-out",level:2}];function d(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",img:"img",li:"li",p:"p",ul:"ul",...(0,o.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"what-is-tfaction",children:"What is tfaction"})}),"\n",(0,i.jsx)(n.p,{children:"tfaction is a set of GitHub Actions for building workflows that run Terraform or OpenTofu on GitHub Actions."}),"\n",(0,i.jsxs)(n.p,{children:["It provides a basic GitHub Flow where ",(0,i.jsx)(n.code,{children:"terraform plan"})," runs on pull requests, and ",(0,i.jsx)(n.code,{children:"terraform apply"})," runs when the PR is merged."]}),"\n",(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Provides simple workflows powered by GitHub Actions","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["No need to run ",(0,i.jsx)(n.code,{children:"terraform apply"})," locally"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["OSS (MIT LICENSE)","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Free to use"}),"\n",(0,i.jsx)(n.li,{children:"No vendor lock-in to SaaS platforms"}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.li,{children:"Supports OpenTofu and Terragrunt"}),"\n",(0,i.jsxs)(n.li,{children:["Feature-rich","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Native support for peripheral tools like tflint, trivy, and conftest in addition to Terraform"}),"\n",(0,i.jsx)(n.li,{children:"Thoughtful details such as automatic code fixes and automatic PR branch updates"}),"\n",(0,i.jsx)(n.li,{children:"Drift Detection support"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Flexibility","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Since it uses GitHub Actions, you can add steps before or after tfaction's steps, or use only specific features -- workflows are highly customizable"}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["Reduced workflow operation and maintenance costs","\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"No need to build workflows from scratch"}),"\n",(0,i.jsx)(n.li,{children:"Features are enabled simply by adding a few lines to declarative configuration files"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:"Below is an overview of tfaction's key features."}),"\n",(0,i.jsx)(n.h2,{id:"monorepo-support",children:"Monorepo Support"}),"\n",(0,i.jsx)(n.p,{children:"Natively supports monorepos that manage multiple Terraform root modules.\nCI runs only for root modules changed in a PR.\nThere is also a feature that triggers CI for a root module when a dependent local-path module is updated."}),"\n",(0,i.jsxs)(n.h2,{id:"clear-pr-comments-for-terraform-plan-and-apply-results",children:["Clear PR Comments for ",(0,i.jsx)(n.code,{children:"terraform plan"})," and ",(0,i.jsx)(n.code,{children:"apply"})," Results"]}),"\n",(0,i.jsxs)(n.p,{children:["Using a tool called ",(0,i.jsx)(n.a,{href:"https://github.com/suzuki-shunsuke/tfcmt",children:"tfcmt"}),", tfaction posts clear and easy-to-read summaries of ",(0,i.jsx)(n.code,{children:"terraform plan"})," and ",(0,i.jsx)(n.code,{children:"apply"})," results directly to pull requests."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/13323303/136236949-bac1a28d-4db2-4a08-900a-708a0a02311c.png",alt:"tfcmt"})}),"\n",(0,i.jsx)(n.h2,{id:"linting",children:"Linting"}),"\n",(0,i.jsxs)(n.p,{children:["Runs linting with tools such as ",(0,i.jsx)(n.code,{children:"terraform validate"}),", ",(0,i.jsx)(n.code,{children:"tflint"}),", ",(0,i.jsx)(n.code,{children:"trivy"}),", and ",(0,i.jsx)(n.code,{children:"conftest"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"tflint"})," and ",(0,i.jsx)(n.code,{children:"trivy"})," results are reported in a developer-friendly way using reviewdog."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/13323303/153742908-2512f73a-1505-4c0c-9284-b6deb8983c2f.png",alt:"tflint"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"conftest"})," can be executed against both HCL files and plan files."]}),"\n",(0,i.jsx)(n.h2,{id:"automatic-code-fixes",children:"Automatic Code Fixes"}),"\n",(0,i.jsxs)(n.p,{children:["Runs ",(0,i.jsx)(n.code,{children:".terraform.lock.hcl"})," updates, ",(0,i.jsx)(n.code,{children:"terraform fmt"}),", ",(0,i.jsx)(n.code,{children:"terraform-docs"}),", ",(0,i.jsx)(n.code,{children:"tflint --fix"}),", and other tools to automatically fix code and push commits to the PR."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/13323303/155866979-52dd2e6f-9885-4af1-bac0-abd1280fdea5.png",alt:"commit"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://user-images.githubusercontent.com/13323303/155866989-8cbcd50e-4764-4f47-a50f-102d04a04f89.png",alt:"fmt"})}),"\n",(0,i.jsx)(n.p,{children:"Additionally, if a PR's feature branch is behind the base branch, it automatically updates the branch.\nIn practice, having issues fixed automatically provides a far better developer experience than simply failing CI."}),"\n",(0,i.jsxs)(n.h2,{id:"safe-apply-using-plan-files",children:["Safe ",(0,i.jsx)(n.code,{children:"apply"})," Using Plan Files"]}),"\n",(0,i.jsxs)(n.p,{children:["The plan file generated during ",(0,i.jsx)(n.code,{children:"terraform plan"})," in the PR is used during ",(0,i.jsx)(n.code,{children:"terraform apply"}),", preventing discrepancies between the plan result and the actual apply."]}),"\n",(0,i.jsxs)(n.h2,{id:"auto-disable-renovate-auto-merge-when-terraform-plan-shows-changes",children:["Auto-disable Renovate Auto-merge When ",(0,i.jsx)(n.code,{children:"terraform plan"})," Shows Changes"]}),"\n",(0,i.jsx)(n.p,{children:"Prevents unexpected changes from being applied when a Renovate PR is auto-merged."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.img,{src:"https://github.com/user-attachments/assets/5c14a9dc-fbb6-44a4-99b3-952dbfe9885d",alt:"renovate"})}),"\n",(0,i.jsxs)(n.h2,{id:"automatically-create-follow-up-prs-when-terraform-apply-fails",children:["Automatically Create Follow-up PRs When ",(0,i.jsx)(n.code,{children:"terraform apply"})," Fails"]}),"\n",(0,i.jsxs)(n.p,{children:["When ",(0,i.jsx)(n.code,{children:"terraform apply"})," fails, tfaction automatically creates a follow-up PR to help address the failure."]}),"\n",(0,i.jsx)(n.h2,{id:"scaffold-working-directory-workflow",children:"Scaffold Working Directory Workflow"}),"\n",(0,i.jsxs)(n.p,{children:["Provides a workflow for adding root modules based on user-defined templates.\nIt is executed via ",(0,i.jsx)(n.code,{children:"workflow_dispatch"}),".\nCompared to running scripts locally, this approach has fewer environment dependencies and makes investigation easier by reviewing the action logs when issues occur."]}),"\n",(0,i.jsx)(n.h2,{id:"drift-detection",children:"Drift Detection"}),"\n",(0,i.jsxs)(n.p,{children:["Periodically detects drift between code and the actual infrastructure state, and manages it via GitHub Issues.\nThe ",(0,i.jsx)(n.code,{children:"plan"})," result is recorded as a comment in the issue, making it easy to identify when drift occurred.\nBecause it leverages GitHub Issues, everything is managed within GitHub."]}),"\n",(0,i.jsx)(n.h2,{id:"support-for-opentofu-and-terragrunt",children:"Support for OpenTofu and Terragrunt"}),"\n",(0,i.jsx)(n.p,{children:"Supports not only Terraform but also Terraform-compatible tools such as OpenTofu, as well as Terragrunt."}),"\n",(0,i.jsx)(n.h2,{id:"tfmigrate",children:"tfmigrate"}),"\n",(0,i.jsxs)(n.p,{children:["Runs ",(0,i.jsx)(n.a,{href:"https://github.com/minamijoyo/tfmigrate",children:"tfmigrate"})," on GitHub Actions to achieve state migration as IaC.\nAlthough the need for tfmigrate has decreased since Terraform officially added support for ",(0,i.jsx)(n.code,{children:"moved"})," blocks, ",(0,i.jsx)(n.code,{children:"removed"})," blocks, and ",(0,i.jsx)(n.code,{children:"import"})," blocks, it remains useful when you need to move resources between states."]}),"\n",(0,i.jsx)(n.h2,{id:"csm-clientserver-model-actions-securefix-action-support",children:"CSM (Client/Server Model) Actions (Securefix Action) Support"}),"\n",(0,i.jsx)(n.p,{children:"CSM Actions applies the Client/Server Model to GitHub Actions, enabling safer commit and PR creation."}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/csm-actions/docs",children:"https://github.com/csm-actions/docs"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://github.com/csm-actions/securefix-action",children:"https://github.com/csm-actions/securefix-action"})}),"\n",(0,i.jsx)(n.p,{children:"tfaction natively supports this."}),"\n",(0,i.jsxs)(n.h2,{id:"import-via-terraform-plan--generate-config-out",children:["Import via ",(0,i.jsx)(n.code,{children:"terraform plan -generate-config-out"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"terraform plan -generate-config-out"})," is a very useful command that generates resource blocks from import blocks."]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.a,{href:"https://developer.hashicorp.com/terraform/language/import",children:"https://developer.hashicorp.com/terraform/language/import"})}),"\n",(0,i.jsxs)(n.p,{children:["tfaction can run this in CI, commit the result, and auto-generate code.\nThis is especially convenient when running ",(0,i.jsx)(n.code,{children:"terraform plan"})," locally is difficult due to permission constraints."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.p,{children:"This concludes the overview of tfaction.\nIn the next chapter, we will implement a simple workflow using the minimum tfaction configuration."})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>s,x:()=>a});var r=t(6540);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);