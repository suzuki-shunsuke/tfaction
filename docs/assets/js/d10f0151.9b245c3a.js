"use strict";(self.webpackChunktfaction=self.webpackChunktfaction||[]).push([[8055],{8224:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>l,frontMatter:()=>r,metadata:()=>s,toc:()=>u});const s=JSON.parse('{"id":"feature/securefix-action","title":"Securefix Action","description":"Securefix Action","source":"@site/docs/feature/securefix-action.md","sourceDirName":"feature","slug":"/feature/securefix-action","permalink":"/tfaction/docs/feature/securefix-action","draft":false,"unlisted":false,"editUrl":"https://github.com/suzuki-shunsuke/tfaction-docs/edit/main/docs/feature/securefix-action.md","tags":[],"version":"current","sidebarPosition":1240,"frontMatter":{"sidebar_position":1240,"description":"Securefix Action"},"sidebar":"tutorialSidebar","previous":{"title":"Limit changed directories","permalink":"/tfaction/docs/feature/limit-changed-dirs"},"next":{"title":"Configuration","permalink":"/tfaction/docs/config/"}}');var i=t(4848),c=t(8453);const r={sidebar_position:1240,description:"Securefix Action"},a="Securefix Action",o={},u=[{value:"Requirements",id:"requirements",level:2},{value:"How to use",id:"how-to-use",level:2}];function _(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"securefix-action",children:"Securefix Action"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.code,{children:"tfaction >= v1.18.0"})}),"\n",(0,i.jsxs)(n.p,{children:["You can fix and generate code and create pull requests by ",(0,i.jsx)(n.a,{href:"https://github.com/csm-actions/securefix-action",children:"Securefix Action"}),".\nBy default, tfaction fixes and generates code and create pull requests using a GitHub access token passed by the input ",(0,i.jsx)(n.code,{children:"github_token"}),", so the token requires ",(0,i.jsx)(n.code,{children:"contents:write"})," permission."]}),"\n",(0,i.jsx)(n.p,{children:"Securefix Action can fix and generate code and create pull requests more securely.\nFor more details, please see the document of Securefix Action."}),"\n",(0,i.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,i.jsxs)(n.p,{children:["Securefix Action v0.1.1 or newer is required.\n",(0,i.jsx)(n.a,{href:"https://github.com/csm-actions/securefix-action",children:"Please set up Securefix Action according to the document."})]}),"\n",(0,i.jsx)(n.h2,{id:"how-to-use",children:"How to use"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsx)(n.li,{children:"Enable this feature by tfaction-root.yaml"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"securefix:\n  server_repository: securefix\n  pull_request:\n    base_branch: main\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsx)(n.li,{children:"Pass Securefix Action Client App id and private key to actions"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/setup@latest\n  id: setup\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n- uses: suzuki-shunsuke/tfaction/test@latest\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n- uses: suzuki-shunsuke/tfaction/plan@latest\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/create-follow-up-pr@latest\n  if: failure()\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/create-scaffold-pr@latest\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/scaffold-tfmigrate@latest\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    migration_name: ${{inputs.migration_name}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/create-scaffold-module-pr@latest\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"- uses: suzuki-shunsuke/tfaction/generate-config-out@latest\n  env:\n    GITHUB_TOKEN: ${{steps.token.outputs.token}}\n  with:\n    github_token: ${{steps.token.outputs.token}}\n    branch: ${{inputs.branch}}\n    file: ${{inputs.file}}\n    securefix_action_app_id: ${{vars.SECUREFIX_ACTION_CLIENT_APP_ID}}\n    securefix_action_app_private_key: ${{secrets.SECUREFIX_ACTION_CLIENT_APP_PRIVATE_KEY}}\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"3",children:["\n",(0,i.jsx)(n.li,{children:"Configuration of Securefix Action Server"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'entries:\n  - client:\n      repositories:\n        - suzuki-shunsuke/tfaction-example\n      branches:\n        - main\n    push:\n      repositories:\n        - suzuki-shunsuke/tfaction-example\n      branches:\n        - "**"\n    pull_request:\n      base_branches:\n        - main\n'})})]})}function l(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(_,{...e})}):_(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>r,x:()=>a});var s=t(6540);const i={},c=s.createContext(i);function r(e){const n=s.useContext(c);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:r(e.components),s.createElement(c.Provider,{value:n},e.children)}}}]);